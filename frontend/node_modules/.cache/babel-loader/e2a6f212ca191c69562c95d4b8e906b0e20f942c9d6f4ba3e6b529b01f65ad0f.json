{"ast":null,"code":"export const login = async (username, password) => {\n  try {\n    const response = await fetch('/login/', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        username,\n        password\n      })\n    });\n    if (!response.ok) throw new Error('Login failed');\n    const data = await response.json();\n    return data; // Returns the response data, which should include the token\n  } catch (error) {\n    throw error; // Rethrows the error to be caught by the caller\n  }\n};\nexport const verify2FACode = async twoFaCode => {\n  try {\n    const userDetails = localStorage.getItem('userDetails');\n    console.log(userDetails.data.username);\n    // Assuming the backend endpoint for 2FA verification is /api/verify_2fa/\n    const response = await fetch('/verify_2fa/', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        username: userDetails.username,\n        code: twoFaCode\n      })\n    });\n    if (!response.ok) throw new Error('2FA verification failed');\n    const data = await response.json();\n    return data; // This should include whether the verification was successful\n  } catch (error) {\n    throw error; // Rethrows the error to be caught by the caller\n  }\n};\nexport const logout = async () => {\n  try {\n    const response = await fetch('/logout/', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Token ${localStorage.getItem('userToken')}`,\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) throw new Error('Logout failed');\n  } catch (error) {\n    console.error(\"Logout error:\", error.message);\n  }\n  localStorage.removeItem('userToken');\n  localStorage.removeItem('is2FAVerified');\n};\nconst register = async userData => {\n  const response = await fetch('/register/', {\n    // Adjust the URL as necessary\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(userData)\n  });\n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.detail || 'Registration failed');\n  }\n  return response.json(); // Assuming the backend returns a token upon successful registration\n};\nconst authService = {\n  login,\n  logout,\n  register\n};\nexport default authService;","map":{"version":3,"names":["login","username","password","response","fetch","method","headers","body","JSON","stringify","ok","Error","data","json","error","verify2FACode","twoFaCode","userDetails","localStorage","getItem","console","log","code","logout","message","removeItem","register","userData","errorData","detail","authService"],"sources":["C:/Users/n1k0m/Documents/Pankki/frontend/src/services/authservice.js"],"sourcesContent":["export const login = async (username, password) => {\r\n  try {\r\n    const response = await fetch('/login/', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ username, password }),\r\n    });\r\n    if (!response.ok) throw new Error('Login failed');\r\n    const data = await response.json();\r\n    return data; // Returns the response data, which should include the token\r\n  } catch (error) {\r\n    throw error; // Rethrows the error to be caught by the caller\r\n  }\r\n};\r\n\r\n\r\nexport const verify2FACode = async (twoFaCode) => {\r\n  try {\r\n    const userDetails = localStorage.getItem('userDetails');\r\n    console.log(userDetails.data.username);\r\n    // Assuming the backend endpoint for 2FA verification is /api/verify_2fa/\r\n    const response = await fetch('/verify_2fa/', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ username: userDetails.username, code: twoFaCode }),\r\n    });\r\n    if (!response.ok) throw new Error('2FA verification failed');\r\n\r\n    const data = await response.json();\r\n    return data; // This should include whether the verification was successful\r\n  } catch (error) {\r\n    throw error; // Rethrows the error to be caught by the caller\r\n  }\r\n};\r\n\r\n\r\nexport const logout = async () => {\r\n  try {\r\n      const response = await fetch('/logout/', {\r\n          method: 'POST',\r\n          headers: {\r\n              'Authorization': `Token ${localStorage.getItem('userToken')}`,\r\n              'Content-Type': 'application/json',\r\n          },\r\n      });\r\n      if (!response.ok) throw new Error('Logout failed');\r\n  } catch (error) {\r\n      console.error(\"Logout error:\", error.message);\r\n  }\r\n  localStorage.removeItem('userToken');\r\n  localStorage.removeItem('is2FAVerified');\r\n};\r\n  \r\n\r\nconst register = async (userData) => {\r\n  const response = await fetch('/register/', { // Adjust the URL as necessary\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify(userData),\r\n  });\r\n  if (!response.ok) {\r\n    const errorData = await response.json();\r\n    throw new Error(errorData.detail || 'Registration failed');\r\n  }\r\n  return response.json(); // Assuming the backend returns a token upon successful registration\r\n};\r\n\r\nconst authService = { login, logout, register};\r\n\r\nexport default authService;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}